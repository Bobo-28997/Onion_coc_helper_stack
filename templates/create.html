{% extends "base.html" %}

{% block title %}
    {% if inv %}ç¼–è¾‘: {{ inv.name }}{% else %}æ–°å»ºè°ƒæŸ¥å‘˜{% endif %}
{% endblock %}

{% block css %}
<style>
    .stat-box { background: white; border: 0px solid #dee2e6; border-radius: 0.375rem; padding: 0.5rem; text-align: center; }
    .card-header { font-weight: bold; background-color: #e9ecef; }
    /* è‡ªå®šä¹‰æŠ€èƒ½çš„åç§°è¾“å…¥æ¡†æ ·å¼ */
    .custom-skill-name {
        border: none !important;
        background: transparent;
        color: #6c757d; /* ä¸æ™®é€šLabelçš„é¢œè‰²ä¸€è‡´ */
        font-size: 0.75rem;
        padding: 0;
        padding-top: 0;
        padding-bottom: 0;
        margin-bottom: 0px;
        border-radius: 0;
        cursor: text;
        text-align: left;
    }

    /* èšç„¦æ—¶ç¨å¾®åŠ æ·±ä¸€ç‚¹ï¼Œä¸è¦é»˜è®¤çš„é«˜äº®è“æ¡†ï¼Œä¿æŒä½è°ƒ */
    .custom-skill-name:focus {
        outline: none;
        border-bottom: 0px solid #495057;
        background: transparent;
        box-shadow: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <h2 class="mb-4">
            {% if inv %}ğŸ“ ç¼–è¾‘è§’è‰²{% else %}ğŸ“„ æ–°å»ºè§’è‰²{% endif %}
        </h2>
        
        <form action="/investigators/save" method="post">
            <input type="hidden" name="id" value="{{ inv.id if inv else '' }}">

            <div class="card mb-4 shadow-sm">
                <div class="card-header"><i class="fas fa-id-card"></i> åŸºç¡€ä¿¡æ¯</div>
                <div class="card-body row g-3">
                    <div class="col-md-3">
                        <label class="form-label">å¡ç‰‡ç±»å‹</label>
                        <select class="form-select" name="card_type">
                            <option value="player" {% if inv and inv.card_type =='player' %}selected{% endif %}>ğŸŸ¢ è°ƒæŸ¥å‘˜ (PC)</option>
                            <option value="npc" {% if inv and inv.card_type =='npc' %}selected{% endif %}>ğŸ”µ NPC</option>
                            <option value="monster" {% if inv and inv.card_type =='monster' %}selected{% endif %}>ğŸ™ æ€ªç‰©/æ•Œäºº</option>
                        </select>
                    </div>

                    <div class="col-md-3">
                        <label class="form-label">æ‰€å±é˜Ÿä¼/åˆ†ç»„</label>
                        <input type="text" class="form-control" name="team_name"
                               value="{{ inv.team_name if inv else 'Alpha' }}"
                               placeholder="å¦‚: Alpha, æ•Œæ–¹Aé˜Ÿ">
                        <div class="form-text small">ç”¨äºåœ¨KPé¢æ¿åˆ†ç»„æ˜¾ç¤º</div>
                    </div>

                    <div class="col-md-2">
                        <label class="form-label">æŠ¤ç”² (æ€ªç‰©)</label>
                        <input type="number" class="form-control" name="armor" value="{{ inv.armor if inv else 0 }}">
                    </div>

                    <div class="w-100"></div>

                    <div class="col-md-4">
                        <label class="form-label">è°ƒæŸ¥å‘˜å§“å</label>
                        <input type="text" class="form-control" name="name" value="{{ inv.name if inv else '' }}" required>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">ç©å®¶æ˜µç§°</label>
                        <input type="text" class="form-control" name="player_name" value="{{ inv.player_name if inv else '' }}">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">èŒä¸š</label>
                        <input type="text" class="form-control" name="occupation" value="{{ inv.occupation if inv else '' }}">
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">æ€§åˆ«</label>
                        <select class="form-select" name="gender">
                            <option value="ç”·" {% if inv and inv.gender =='ç”·' %}selected{% endif %}>ç”·</option>
                            <option value="å¥³" {% if inv and inv.gender =='å¥³' %}selected{% endif %}>å¥³</option>
                            <option value="å…¶ä»–" {% if inv and inv.gender =='å…¶ä»–' %}selected{% endif %}>å…¶ä»–</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">å¹´é¾„</label>
                        <input type="number" class="form-control" name="age" value="{{ inv.age if inv else 20 }}">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">æ¯è¯­</label>
                        <input type="text" class="form-control" name="mother_tongue" value="{{ inv.mother_tongue if inv else '' }}">
                    </div>
                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-header"><i class="fas fa-heartbeat"></i> æ ¸å¿ƒå±æ€§</div>
                <div class="card-body">
                    <div class="row g-2 justify-content-center">
                        {% macro stat_input(label, name, value) %}
                        <div class="col-6 col-md-2">
                            <div class="stat-box">
                                <label class="d-block small text-muted mb-1">{{ label }}</label>
                                <input type="number" class="form-control form-control-sm text-center fw-bold" 
                                       name="{{ name }}" value="{{ value }}">
                            </div>
                        </div>
                        {% endmacro %}

                        {{ stat_input('åŠ›é‡ STR (3d6)', 'str_stat', inv.str_stat if inv else 50) }}
                        {{ stat_input('æ•æ· DEX (3d6)', 'dex_stat', inv.dex_stat if inv else 50) }}
                        {{ stat_input('æ„å¿— POW (3d6)', 'pow_stat', inv.pow_stat if inv else 50) }}
                        {{ stat_input('ä½“è´¨ CON (3d6)', 'con_stat', inv.con_stat if inv else 50) }}
                        {{ stat_input('å¤–è²Œ APP (3d6)', 'app_stat', inv.app_stat if inv else 50) }}
                        <div class="w-100"></div>
                        {{ stat_input('ä½“å‹ SIZ (2d6+6)', 'siz_stat', inv.siz_stat if inv else 50) }}
                        {{ stat_input('æ™ºåŠ› INT (2d6+6)', 'int_stat', inv.int_stat if inv else 50) }}
                        {{ stat_input('æ•™è‚² EDU (2d6+6)', 'edu_stat', inv.edu_stat if inv else 50) }}
                        {{ stat_input('å¹¸è¿ LUCK (3d6)', 'luck_stat', inv.luck_stat if inv else 50) }}
                    </div>
                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-header"><i class="fas fa-droplet"></i> å½“å‰çŠ¶æ€</div>
                <div class="card-body">
                    <div class="row g-2 justify-content-center">
                        {% macro stat_input(label, name, value) %}
                        <div class="col-6 col-md-2">
                            <div class="stat-box">
                                <label class="d-block small text-muted mb-1">{{ label }}</label>
                                <input type="number" class="form-control form-control-sm text-center fw-bold"
                                       name="{{ name }}" value="{{ value }}">
                            </div>
                        </div>
                        {% endmacro %}

                        {{ stat_input('ç”Ÿå‘½å€¼', 'hp_current', inv.hp_current if inv else 10) }}
                        {{ stat_input('é­”æ³•å€¼', 'mp_current', inv.mp_current if inv else 10) }}
                        {{ stat_input('ç†æ™ºå€¼', 'san_current', inv.san_current if inv else 50) }}
                        {{ stat_input('ä¼¤å®³åŠ å€¼', 'db_val', inv.db_val if inv else 0) }}
                        <div class="w-100"></div>
                        {{ stat_input('ç”Ÿå‘½ä¸Šé™', 'hp_max', inv.hp_max if inv else 10) }}
                        {{ stat_input('é­”æ³•ä¸Šé™', 'mp_max', inv.mp_max if inv else 10) }}

                    </div>
                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-header"><i class="fas fa-address-book"></i> è°ƒæŸ¥å‘˜æŠ€èƒ½</div>
                <div class="card-body">
                    <div class="row g-2 justify-content-center">
                        {% macro stat_input(label, name, value) %}
                        <div class="col-6 col-md-2">
                            <div class="stat-box">
                                <label class="d-block small text-muted mb-1">{{ label }}</label>
                                <input type="number" class="form-control form-control-sm text-center fw-bold"
                                       name="{{ name }}" value="{{ value }}">
                            </div>
                        </div>
                        {% endmacro %}

                        {% macro custom_skill_input(category, name_field, val_field, name_val, val_val) %}
                        <div class="col-6 col-md-2"> <div class="stat-box position-relative">
                                <div class="d-flex align-items-center justify-content-center mb-1">
                                    <span class="text-muted text-nowrap" style="font-size: 0.75rem;">{{ category }}:</span>

                                    <input type="text"
                                           class="form-control form-control-sm custom-skill-name ps-1"
                                           placeholder="è¯·è¾“å…¥..."
                                           style="min-width: 0;"
                                           name="{{ name_field }}"
                                           value="{{ name_val }}">
                                </div>

                                <input type="number"
                                       class="form-control form-control-sm text-center fw-bold"
                                       name="{{ val_field }}"
                                       value="{{ val_val }}">
                            </div>
                        </div>
                        {% endmacro %}

                        {{ stat_input('å…‹è‹é²ç¥è¯', 'cthulhu_mythos', inv.cthulhu_mythos if inv else 0) }}
                        <div class="w-100"></div>
                        {{ stat_input('ä¿¡ç”¨è¯„çº§', 'credit_rating', inv.credit_rating if inv else 0) }}
                        {{ stat_input('ä¾¦å¯Ÿ', 'spot_hidden', inv.spot_hidden if inv else 25) }}
                        {{ stat_input('è†å¬', 'listen', inv.listen if inv else 20) }}
                        {{ stat_input('å›¾ä¹¦é¦†ä½¿ç”¨', 'library_use', inv.library_use if inv else 20) }}
                        <div class="w-100"></div>
                        {{ stat_input('æ€¥æ•‘', 'first_aid', inv.first_aid if inv else 30) }}
                        {{ stat_input('åŒ»å­¦', 'medicine', inv.medicine if inv else 1) }}
                        {{ stat_input('ç²¾ç¥åˆ†æ', 'psychoanalysis', inv.psychoanalysis if inv else 1) }}
                        <div class="w-100"></div>
                        {{ stat_input('å–æ‚¦', 'charm', inv.charm if inv else 15) }}
                        {{ stat_input('è¯æœ¯', 'fast_talk', inv.fast_talk if inv else 5) }}
                        {{ stat_input('æå“', 'intimidate', inv.intimidate if inv else 15) }}
                        {{ stat_input('è¯´æœ', 'persuade', inv.persuade if inv else 10) }}
                        <div class="w-100"></div>
                        {{ stat_input('ä¼šè®¡', 'accounting', inv.accounting if inv else 5) }}
                        {{ stat_input('ä¼°ä»·', 'appraise', inv.appraise if inv else 5) }}
                        {{ stat_input('è€ƒå¤å­¦', 'archaeology', inv.archaeology if inv else 1) }}
                        {{ stat_input('äººç±»å­¦', 'anthropology', inv.anthropology if inv else 1) }}
                        {{ stat_input('æ³•å¾‹', 'law', inv.law if inv else 5) }}
                        {{ stat_input('å†å²', 'history', inv.history if inv else 5) }}
                        {{ stat_input('ç¥ç§˜å­¦', 'occult', inv.occult if inv else 5) }}
                        {{ stat_input('åšç‰©å­¦', 'natural_world', inv.natural_world if inv else 10) }}
                        {{ stat_input('å¿ƒç†å­¦', 'psychology', inv.psychology if inv else 10) }}
                        {{ custom_skill_input(
                            'ç§‘å­¦A',
                            'science_a_name', 'science_a_val',
                            inv.science_a_name if inv else '',
                            inv.science_a_val if inv else 1
                        ) }}
                        {{ custom_skill_input(
                            'ç§‘å­¦B',
                            'science_b_name', 'science_b_val',
                            inv.science_b_name if inv else '',
                            inv.science_b_val if inv else 1
                        ) }}
                        {{ custom_skill_input(
                            'ç§‘å­¦C',
                            'science_c_name', 'science_c_val',
                            inv.science_c_name if inv else '',
                            inv.science_c_val if inv else 1
                        ) }}
                        <div class="w-100"></div>
                        {{ stat_input('éª‘æœ¯', 'ride', inv.ride if inv else 5) }}
                        {{ stat_input('æ±½è½¦é©¾é©¶', 'drive_auto', inv.drive_auto if inv else 5) }}
                        {{ custom_skill_input(
                            'è½½å…·é©¾é©¶',
                            'drive_a_name', 'drive_a_val',
                            inv.drive_a_name if inv else '',
                            inv.drive_a_val if inv else 1
                        ) }}
                        <div class="w-100"></div>
                        {{ stat_input('é”åŒ ', 'locksmith', inv.locksmith if inv else 5) }}
                        {{ stat_input('æœºæ¢°ç»´ä¿®', 'mech_repair', inv.mech_repair if inv else 10) }}
                        {{ stat_input('ç”µæ°”ç»´ä¿®', 'elec_repair', inv.elec_repair if inv else 10) }}
                        <div class="w-100"></div>
                        {{ stat_input('æ”€çˆ¬', 'climb', inv.climb if inv else 20) }}
                        {{ stat_input('è·³è·ƒ', 'jump', inv.jump if inv else 20) }}
                        {{ stat_input('æ¸¸æ³³', 'swim', inv.locksmith if inv else 20) }}
                        {{ stat_input('æ½œè¡Œ', 'stealth', inv.stealth if inv else 20) }}
                        {{ stat_input('è¿½è¸ª', 'track', inv.track if inv else 10) }}
                        {{ stat_input('å¿«æ‰‹', 'sleight_of_hand', inv.sleight_of_hand if inv else 10) }}
                        {{ stat_input('ä¹”è£…', 'disguise', inv.disguise if inv else 5) }}
                        {{ stat_input('å¯¼èˆª', 'navigate', inv.navigate if inv else 10) }}
                        {{ stat_input('ç”Ÿå­˜', 'survival', inv.survival if inv else 10) }}
                        <div class="w-100"></div>
                        {{ stat_input('é—ªé¿(æ•æ·/2)', 'dodge', inv.dodge if inv else 25) }}
                        {{ stat_input('æŠ•æ·', 'throw', inv.throw if inv else 20) }}
                        {{ stat_input('æ ¼æ–—ï¼šæ–—æ®´', 'fighting_brawl', inv.fighting_brawl if inv else 25) }}
                        {{ custom_skill_input(
                            'æ ¼æ–—B',
                            'fighting_b_name', 'fighting_b_val',
                            inv.fighting_b_name if inv else '',
                            inv.fighting_b_val if inv else 1
                        ) }}
                        {{ custom_skill_input(
                            'æ ¼æ–—C',
                            'fighting_c_name', 'fighting_c_val',
                            inv.fighting_c_name if inv else '',
                            inv.fighting_c_val if inv else 1
                        ) }}
                        {{ stat_input('å°„å‡»ï¼šæ‰‹æª', 'firearms_handgun', inv.firearms_handgun if inv else 25) }}
                        {{ stat_input('å°„å‡»ï¼šæ­¥æª', 'firearms_rifle', inv.firearms_rifle if inv else 25) }}
                        {{ custom_skill_input(
                            'å°„å‡»C',
                            'firearms_c_name', 'firearms_c_val',
                            inv.firearms_c_name if inv else '',
                            inv.firearms_c_val if inv else 1
                        ) }}
                        <div class="w-100"></div>
                        {{ stat_input('æ¯è¯­(æ•™è‚²)', 'language', inv.language if inv else 25) }}
                        {{ custom_skill_input(
                            'ç¬¬äºŒè¯­è¨€',
                            'language_b_name', 'language_b_val',
                            inv.language_b_name if inv else '',
                            inv.language_b_val if inv else 1
                        ) }}
                        {{ custom_skill_input(
                            'ç¬¬ä¸‰è¯­è¨€',
                            'language_c_name', 'language_c_val',
                            inv.language_c_name if inv else '',
                            inv.language_c_val if inv else 1
                        ) }}
                        {{ custom_skill_input(
                            'æŠ€è‰ºA',
                            'craft_a_name', 'craft_a_val',
                            inv.craft_a_name if inv else '',
                            inv.craft_a_val if inv else 1
                        ) }}
                        {{ custom_skill_input(
                            'æŠ€è‰ºB',
                            'craft_b_name', 'craft_b_val',
                            inv.craft_b_name if inv else '',
                            inv.craft_b_val if inv else 1
                        ) }}


                    </div>
                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-danger text-white">
                    <i class="fas fa-skull-crossbones"></i> æˆ˜æ–—ä¸æ­¦å™¨
                </div>
                <div class="card-body p-3">

                    <div class="row g-2 mb-2 text-muted small fw-bold text-center">
                        <div class="col-4">æ­¦å™¨/æŠ€èƒ½åç§°</div>
                        <div class="col-2">æˆåŠŸç‡ %</div>
                        <div class="col-6">ä¼¤å®³ / æè¿° (å¦‚ 1d4+db)</div>
                    </div>

                    <hr class="my-2">

                    {% macro combat_row_fixed(label, skill_name, skill_val, dmg_name, dmg_val) %}
                    <div class="row g-2 align-items-center mb-2">
                        <div class="col-4 text-end align-self-center">
                            <span class="fw-bold text-dark">{{ label }}</span>
                        </div>
                        <div class="col-2">
                            <input type="number" class="form-control form-control-sm text-center fw-bold"
                                   name="{{ skill_name }}"
                                   value="{{ skill_val }}">
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control form-control-sm"
                                   placeholder="å¦‚: 1d3+db"
                                   name="{{ dmg_name }}"
                                   value="{{ dmg_val }}">
                        </div>
                    </div>
                    {% endmacro %}

                    {% macro combat_row_custom(name_field, name_val, skill_field, skill_val, dmg_field, dmg_val, placeholder_name) %}
                    <div class="row g-2 align-items-center mb-2">
                        <div class="col-4">
                            <input type="text" class="form-control form-control-sm text-end"
                                   placeholder="{{ placeholder_name }}"
                                   name="{{ name_field }}"
                                   value="{{ name_val }}">
                        </div>
                        <div class="col-2">
                            <input type="text" class="form-control form-control-sm"
                                   placeholder="æŠ€èƒ½å€¼"
                                   name="{{ dmg_field }}"
                                   value="{{ dmg_val }}">
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control form-control-sm"
                                   placeholder="å¦‚: 1d3+db"
                                   name="{{ dmg_name }}"
                                   value="{{ dmg_val }}">
                        </div>
                    </div>
                    {% endmacro %}

                    <div class="mb-3">
                        <h6 class="text-muted border-bottom pb-1 mb-2"><i class="fas fa-fist-raised"></i> è¿‘æˆ˜æ ¼æ–—</h6>

                        {{ combat_row_fixed(
                            'æ ¼æ–—(æ–—æ®´)',
                            'fighting_brawl', inv.fighting_brawl if inv else 25,
                            'fighting_damage_a', inv.fighting_damage_a if inv else ''
                        ) }}

                        {{ combat_row_custom(
                            'fighting_b_name', inv.fighting_b_name if inv else '',
                            'fighting_b_val', inv.fighting_b_val if inv else 0,
                            'fighting_damage_b', inv.fighting_damage_b if inv else '',
                            'æ ¼æ–—B'
                        ) }}

                        {{ combat_row_custom(
                            'fighting_c_name', inv.fighting_c_name if inv else '',
                            'fighting_c_val', inv.fighting_c_val if inv else 0,
                            'fighting_damage_c', inv.fighting_damage_c if inv else '',
                            'æ ¼æ–—C'
                        ) }}

                        {{ combat_row_fixed(
                            'å°„å‡»(æ‰‹æª)',
                            'firearms_handgun', inv.firearms_handgun if inv else 25,
                            'firearms_damage_a', inv.firearms_damage_a if inv else ''
                        ) }}

                        {{ combat_row_fixed(
                            'å°„å‡»(æ­¥æª)',
                            'firearms_rifle', inv.firearms_rifle if inv else 25,
                            'firearms_damage_b', inv.firearms_damage_b if inv else ''
                        ) }}

                        {{ combat_row_custom(
                            'firearms_c_name', inv.firearms_c_name if inv else '',
                            'firearms_c_val', inv.firearms_c_val if inv else 0,
                            'firearms_damage_c', inv.firearms_damage_c if inv else '',
                            'ç«å™¨C'
                        ) }}
                    </div>

                    <div class="row g-2 align-items-center bg-light p-1 rounded">
                        <div class="col-4 text-end align-self-center">
                            <span class="fw-bold text-secondary">é—ªé¿</span>
                        </div>
                        <div class="col-2">
                            <input type="number" class="form-control form-control-sm text-center fw-bold"
                                   name="dodge"
                                   value="{{ inv.dodge if inv else '' }}"> </div>
                         <div class="col-6 text-muted small pt-1">
                            *é—ªé¿é€šå¸¸ä¸º æ•æ·çš„ä¸€åŠ
                        </div>
                    </div>

                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-header"><i class="fas fa-box"></i> èƒŒåŒ…</div>
                <div class="card-body row g-3">
                    <div class="col-md-3">
                        <label class="form-label">ç‰©å“1</label>
                        <input type="text" class="form-control" name="item_1" value="{{ inv.item_1 if inv else '' }}">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">ç‰©å“2</label>
                        <input type="text" class="form-control" name="item_2" value="{{ inv.item_2 if inv else '' }}">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">ç‰©å“3</label>
                        <input type="text" class="form-control" name="item_3" value="{{ inv.item_3 if inv else '' }}">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">ç‰©å“4</label>
                        <input type="text" class="form-control" name="item_4" value="{{ inv.item_4 if inv else '' }}">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">ç‰©å“5</label>
                        <input type="text" class="form-control" name="item_5" value="{{ inv.item_5 if inv else '' }}">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">ç‰©å“6</label>
                        <input type="text" class="form-control" name="item_6" value="{{ inv.item_6 if inv else '' }}">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">ç‰©å“7</label>
                        <input type="text" class="form-control" name="item_7" value="{{ inv.item_7 if inv else '' }}">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">ç‰©å“8</label>
                        <input type="text" class="form-control" name="item_8" value="{{ inv.item_8 if inv else '' }}">
                    </div>
                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-header"><i class="fas fa-user"></i> èƒŒæ™¯ä¿¡æ¯</div>
                <div class="card-body row g-3">
                    <div class="col-md-12">
                        <label class="form-label">å½¢è±¡æè¿°</label>
                        <input type="text" class="form-control" name="description" value="{{ inv.description if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">æ€æƒ³ä¸ä¿¡å¿µ</label>
                        <input type="text" class="form-control" name="ideology" value="{{ inv.ideology if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">é‡è¦ä¹‹äºº</label>
                        <input type="text" class="form-control" name="significant_people" value="{{ inv.significant_people if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">é‡è¦ä¹‹åœ°</label>
                        <input type="text" class="form-control" name="significant_location" value="{{ inv.significant_location if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">å®è´µä¹‹ç‰©</label>
                        <input type="text" class="form-control" name="treasured_possession" value="{{ inv.treasured_possession if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">ç‰¹è´¨</label>
                        <input type="text" class="form-control" name="traits" value="{{ inv.traits if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">ä¼¤å£ä¸ä¼¤ç–¤</label>
                        <input type="text" class="form-control" name="injuries" value="{{ inv.injuries if inv else '' }}">
                    </div>
                </div>
            </div>

            <div class="card mb-4 shadow-sm">
                <div class="card-header"><i class="fas fa-list-check"></i> ç»å†æ¨¡ç»„ä¸æŒæ¡æ³•æœ¯</div>
                <div class="card-body row g-3">
                    <div class="col-md-12">
                        <label class="form-label">ç»å†æ¨¡ç»„1</label>
                        <input type="text" class="form-control" name="history_text_1" value="{{ inv.history_text_1 if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">ç»å†æ¨¡ç»„2</label>
                        <input type="text" class="form-control" name="history_text_2" value="{{ inv.history_text_2 if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">ç»å†æ¨¡ç»„3</label>
                        <input type="text" class="form-control" name="history_text_3" value="{{ inv.history_text_3 if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">ç»å†æ¨¡ç»„4</label>
                        <input type="text" class="form-control" name="history_text_4" value="{{ inv.history_text_4 if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">æ³•æœ¯1</label>
                        <input type="text" class="form-control" name="spells_text_1" value="{{ inv.spells_text_1 if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">æ³•æœ¯2</label>
                        <input type="text" class="form-control" name="spells_text_2" value="{{ inv.spells_text_2 if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">æ³•æœ¯3</label>
                        <input type="text" class="form-control" name="spells_text_3" value="{{ inv.spells_text_3 if inv else '' }}">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">æ³•æœ¯4</label>
                        <input type="text" class="form-control" name="spells_text_4" value="{{ inv.spells_text_4 if inv else '' }}">
                    </div>
                </div>
            </div>

            <div class="d-flex gap-2 justify-content-end">
                <a href="/" class="btn btn-secondary">å–æ¶ˆ</a>
                <button type="submit" class="btn btn-success px-5">
                    <i class="fas fa-save"></i> ä¿å­˜
                </button>
            </div>
            
            <br>
            <div class="alert alert-info">
                æç¤ºï¼šæŠ€èƒ½åˆ—è¡¨ã€ç‰©å“æ ç­‰è¯·ç»§ç»­æŒ‰ç…§ä¸Šè¿° `macro` æ¨¡å¼è¡¥å……åœ¨ä¸‹æ–¹ã€‚
            </div>

        </form>
    </div>
</div>
{% endblock %}